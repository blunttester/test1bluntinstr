!function(s){var c,_={locality:"long_name",administrative_area_level_1:"short_name",country:"long_name",postal_code:"short_name"},d={locality:"_wcv_store_city",administrative_area_level_1:"_wcv_store_state",country:"_wcv_store_country",postal_code:"_wcv_store_postcode"},a=function(e){var o=null!=e&&null!=e?e:c.getPlace();if(null!=o&&null!=o){s("#_wcv_store_city").val(""),s("#_wcv_store_state").val(""),s("#_wcv_store_country").val(""),s("#_wcv_store_postcode").val("");for(var t=o.formatted_address.split(",")[0],a=0;a<o.address_components.length;a++){var n=o.address_components[a].types[0];if(d[n]){var r=o.address_components[a][_[n]];if("country"==n){var l=o.address_components[a].short_name;s("#_wcv_store_country").val(l).trigger("change")}else document.getElementById(d[n]).value=r}}t=t.trim(),s("#_wcv_store_search_address").val(o.formatted_address),s("#_wcv_store_address1").val(t),i(o.geometry.location.lat(),o.geometry.location.lng())}},n=function(t,a,n){var e=s("#_wcv_store_search_address").val();t.geocode({address:e},function(e,o){"OK"===o?(n.setCenter(e[0].geometry.location),n.setCenter({lat:parseFloat(e[0].geometry.location.lat()),lng:parseFloat(e[0].geometry.location.lng())}),google.maps.event.addListener(a,"dragend",function(e){r({geocoder:t,marker:a,map:n,what:"latlng",position:e.latLng}),n.panTo(e.latLng)}),n.addListener("click",function(e){r({geocoder:t,marker:a,map:n,what:"latlng",position:e.latLng}),n.panTo(e.latLng)})):console.log("Geocode was not successful for the following reason: "+o)})};function r(t){var e;if("address"==t.what)e={address:document.getElementById("_wcv_store_search_address").value};else if("latlng"==t.what){e={location:{lat:parseFloat(t.position.lat()),lng:parseFloat(t.position.lng())}}}null!=e&&t.geocoder.geocode(e,function(e,o){o==google.maps.GeocoderStatus.OK?("address"==t.what&&s("#_wcv_store_search_address").val(e[0].formatted_address),t.map.setCenter({lat:parseFloat(e[0].geometry.location.lat()),lng:parseFloat(e[0].geometry.location.lng())}),t.marker.setPosition({lat:parseFloat(e[0].geometry.location.lat()),lng:parseFloat(e[0].geometry.location.lng())}),a(e[0]),t.map.panTo(e[0].geometry.location)):console.log(wcv_frontend_general.cannot_find_address_text+" "+o)})}function t(){navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(e){var o=e.coords.latitude,t=e.coords.longitude,a=new google.maps.LatLng(o,t);(new google.maps.Geocoder).geocode({latLng:a},function(e,o){o===google.maps.GeocoderStatus.OK&&e[0]&&s("#_wcv_store_search_address").val(e[0].formatted_address).trigger("change")})})}var i=function(e,o){s("#wcv_address_latitude").val(e),s("#wcv_address_longitude").val(o)},l=function(){return""!=s("#wcv_address_latidude").val()&&null!=s("#wcv_address_latidude").val()?parseFloat(s("#wcv_address_latitude").val()):-34.397},g=function(){return""!=s("#wcv_address_longitude").val()&&null!=s("#wcv_address_longitude").val()?parseFloat(s("#wcv_address_longitude").val()):29.644};s(document).ready(function(){var e=function(){if(0==s("#_wcv_store_search_address").val().length)return"";var e=s("#_wcv_store_address1").val(),o=s("#_wcv_store_state").val(),t=s("#_wcv_store_country").val(),a=e+" "+o+" "+s("#_wcv_store_postcode").val()+" "+t;return a=(a=a.replace(/ +(?= )/g,"")).trim()}(),o=s("#_wcv_store_search_address");o.on("change",function(){!function(){if("undefined"!=typeof google&&google){c=new google.maps.places.Autocomplete(document.getElementById("_wcv_store_search_address"),{types:["geocode"]});var e=new google.maps.Map(document.getElementById("wcv_location_picker"),{zoom:parseInt(wcv_frontend_general.map_zoom_level),center:{lat:l(),lng:g()}}),o=new google.maps.Geocoder,t=new google.maps.Marker({map:e,position:new google.maps.LatLng(l(),g()),draggable:!0,animation:google.maps.Animation.DROP});n(o,t,e),r({geocoder:o,marker:t,map:e,what:"address"}),c.addListener("place_changed",function(){a(null),r({geocoder:o,marker:t,map:e,what:"address"})})}else s("#wcv_location_picker").hide()}()}),s("#show_location_picker").click(function(e){e.preventDefault(),s("#wcv_location_picker").toggle(),s("#wcv_location_picker").is(":visible")?s("#show_location_picker").text(wcv_frontend_general.hide_location_picker_text):s("#show_location_picker").text(wcv_frontend_general.use_location_picker_text)}),s("#use_current_position").click(function(e){e.preventDefault(),t()}),0<e.length?o.val(e).trigger("change"):t()})}(jQuery);