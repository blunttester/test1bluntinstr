!function(i){function t(){var e,o,t,a,n,r,s;"undefined"!=typeof google&&google?(g=new google.maps.places.Autocomplete(document.getElementById("_wcv_store_search_address"),{types:["geocode"]}),e=new google.maps.Map(document.getElementById("wcv_location_picker"),{zoom:parseInt(wcv_frontend_general.map_zoom_level),center:{lat:_(),lng:d()}}),o=new google.maps.Geocoder,t=new google.maps.Marker({map:e,position:new google.maps.LatLng(_(),d()),draggable:!0,animation:google.maps.Animation.DROP}),a=o,n=t,r=e,s=i("#_wcv_store_search_address").val(),a.geocode({address:s},function(e,o){"OK"===o?(r.setCenter(e[0].geometry.location),r.setCenter({lat:parseFloat(e[0].geometry.location.lat()),lng:parseFloat(e[0].geometry.location.lng())}),google.maps.event.addListener(n,"dragend",function(e){c({geocoder:a,marker:n,map:r,what:"latlng",position:e.latLng}),r.panTo(e.latLng)}),r.addListener("click",function(e){c({geocoder:a,marker:n,map:r,what:"latlng",position:e.latLng}),r.panTo(e.latLng)})):console.log("Geocode was not successful for the following reason: "+o)}),c({geocoder:o,marker:t,map:e,what:"address"}),g.addListener("place_changed",function(){l(null),c({geocoder:o,marker:t,map:e,what:"address"})})):i("#wcv_location_picker").hide()}var g,v={locality:"long_name",administrative_area_level_1:"short_name",country:"long_name",postal_code:"short_name"},u={locality:"_wcv_store_city",administrative_area_level_1:"_wcv_store_state",country:"_wcv_store_country",postal_code:"_wcv_store_postcode"},l=function(e){var o=null!=e?e:g.getPlace();if(null!=o){i("#_wcv_store_city").val(""),i("#_wcv_store_state").val(""),i("#_wcv_store_country").val(""),i("#_wcv_store_postcode").val("");var t=o=>e=>e.types[0]==o;const l=o.formatted_address,c=o.address_components;e=c.find(t("route"));const _=c.find(t("street_number"))?.short_name;if(e&&_){t=e.short_name,e=e.long_name;const d=l.includes(t)?t:e;t=[d,_].join(" "),e=[_,d].join(" "),e=(e=l.includes(t)?t:e).trim();i("#_wcv_store_search_address").val(o.formatted_address),i("#_wcv_store_address1").val(e)}for(var a=0;a<o.address_components.length;a++){var n,r,s=o.address_components[a].types[0];u[s]&&(n=o.address_components[a][v[s]],"country"==s?(r=o.address_components[a].short_name,i("#_wcv_store_country").val(r).trigger("change")):document.getElementById(u[s]).value=n)}m(o.geometry.location.lat(),o.geometry.location.lng())}};function c(t){var e;"address"==t.what?e={address:document.getElementById("_wcv_store_search_address").value}:"latlng"==t.what&&(e={location:{lat:parseFloat(t.position.lat()),lng:parseFloat(t.position.lng())}}),null!=e&&t.geocoder.geocode(e,function(e,o){o==google.maps.GeocoderStatus.OK?("address"==t.what&&i("#_wcv_store_search_address").val(e[0].formatted_address),t.map.setCenter({lat:parseFloat(e[0].geometry.location.lat()),lng:parseFloat(e[0].geometry.location.lng())}),t.marker.setPosition({lat:parseFloat(e[0].geometry.location.lat()),lng:parseFloat(e[0].geometry.location.lng())}),l(e[0]),t.map.panTo(e[0].geometry.location)):console.log(wcv_frontend_general.cannot_find_address_text+" "+o)})}function _(){return""!=i("#wcv_address_latidude").val()&&null!=i("#wcv_address_latidude").val()?parseFloat(i("#wcv_address_latitude").val()):-34.397}function d(){return""!=i("#wcv_address_longitude").val()&&null!=i("#wcv_address_longitude").val()?parseFloat(i("#wcv_address_longitude").val()):29.644}function a(){navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(e){var o=e.coords.latitude,e=e.coords.longitude,e=new google.maps.LatLng(o,e);(new google.maps.Geocoder).geocode({latLng:e},function(e,o){o===google.maps.GeocoderStatus.OK&&e[0]&&i("#_wcv_store_search_address").val(e[0].formatted_address).trigger("change")})})}var m=function(e,o){i("#wcv_address_latitude").val(e),i("#wcv_address_longitude").val(o)};i(document).ready(function(){var e=function(){if(0==i("#_wcv_store_search_address").val().length)return"";var e=i("#_wcv_store_address1").val(),o=i("#_wcv_store_state").val(),t=i("#_wcv_store_country").val(),t=e+" "+o+" "+i("#_wcv_store_postcode").val()+" "+t;return t=(t=t.replace(/ +(?= )/g,"")).trim()}(),o=i("#_wcv_store_search_address");o.on("change",function(){t()}),i("#show_location_picker").click(function(e){e.preventDefault(),i("#wcv_location_picker").toggle(),i("#wcv_location_picker").is(":visible")?i("#show_location_picker").text(wcv_frontend_general.hide_location_picker_text):i("#show_location_picker").text(wcv_frontend_general.use_location_picker_text)}),i("#use_current_position").click(function(e){e.preventDefault(),a()}),0<e.length?o.val(e).trigger("change"):a()})}(jQuery);