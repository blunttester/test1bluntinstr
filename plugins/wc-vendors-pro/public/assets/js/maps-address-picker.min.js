!function(l){var s,c={locality:"long_name",administrative_area_level_1:"short_name",country:"long_name",postal_code:"short_name"},_={locality:"_wcv_store_city",administrative_area_level_1:"_wcv_store_state",country:"_wcv_store_country",postal_code:"_wcv_store_postcode"},a=function(e){var o=null!=e&&null!=e?e:s.getPlace();if(null!=o&&null!=o){l("#_wcv_store_city").val(""),l("#_wcv_store_state").val(""),l("#_wcv_store_country").val(""),l("#_wcv_store_postcode").val("");for(var e=o.formatted_address.split(",")[0],t=0;t<o.address_components.length;t++){var a,n,r=o.address_components[t].types[0];_[r]&&(a=o.address_components[t][c[r]],"country"==r?(n=o.address_components[t].short_name,l("#_wcv_store_country").val(n).trigger("change")):document.getElementById(_[r]).value=a)}e=e.trim(),l("#_wcv_store_search_address").val(o.formatted_address),l("#_wcv_store_address1").val(e),d(o.geometry.location.lat(),o.geometry.location.lng())}},n=function(t,a,n){var e=l("#_wcv_store_search_address").val();t.geocode({address:e},function(e,o){"OK"===o?(n.setCenter(e[0].geometry.location),n.setCenter({lat:parseFloat(e[0].geometry.location.lat()),lng:parseFloat(e[0].geometry.location.lng())}),google.maps.event.addListener(a,"dragend",function(e){r({geocoder:t,marker:a,map:n,what:"latlng",position:e.latLng}),n.panTo(e.latLng)}),n.addListener("click",function(e){r({geocoder:t,marker:a,map:n,what:"latlng",position:e.latLng}),n.panTo(e.latLng)})):console.log("Geocode was not successful for the following reason: "+o)})};function r(t){var e;"address"==t.what?e={address:document.getElementById("_wcv_store_search_address").value}:"latlng"==t.what&&(e={location:{lat:parseFloat(t.position.lat()),lng:parseFloat(t.position.lng())}}),null!=e&&t.geocoder.geocode(e,function(e,o){o==google.maps.GeocoderStatus.OK?("address"==t.what&&l("#_wcv_store_search_address").val(e[0].formatted_address),t.map.setCenter({lat:parseFloat(e[0].geometry.location.lat()),lng:parseFloat(e[0].geometry.location.lng())}),t.marker.setPosition({lat:parseFloat(e[0].geometry.location.lat()),lng:parseFloat(e[0].geometry.location.lng())}),a(e[0]),t.map.panTo(e[0].geometry.location)):console.log(wcv_frontend_general.cannot_find_address_text+" "+o)})}function t(){navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(e){var o=e.coords.latitude,e=e.coords.longitude,e=new google.maps.LatLng(o,e);(new google.maps.Geocoder).geocode({latLng:e},function(e,o){o===google.maps.GeocoderStatus.OK&&e[0]&&l("#_wcv_store_search_address").val(e[0].formatted_address).trigger("change")})})}var d=function(e,o){l("#wcv_address_latitude").val(e),l("#wcv_address_longitude").val(o)},i=function(){return""!=l("#wcv_address_latidude").val()&&null!=l("#wcv_address_latidude").val()?parseFloat(l("#wcv_address_latitude").val()):-34.397},g=function(){return""!=l("#wcv_address_longitude").val()&&null!=l("#wcv_address_longitude").val()?parseFloat(l("#wcv_address_longitude").val()):29.644};l(document).ready(function(){var e=function(){if(0==l("#_wcv_store_search_address").val().length)return"";var e=l("#_wcv_store_address1").val(),o=l("#_wcv_store_state").val(),t=l("#_wcv_store_country").val(),t=e+" "+o+" "+l("#_wcv_store_postcode").val()+" "+t;return t=(t=t.replace(/ +(?= )/g,"")).trim()}(),o=l("#_wcv_store_search_address");o.on("change",function(){var e,o,t;"undefined"!=typeof google&&google?(s=new google.maps.places.Autocomplete(document.getElementById("_wcv_store_search_address"),{types:["geocode"]}),e=new google.maps.Map(document.getElementById("wcv_location_picker"),{zoom:parseInt(wcv_frontend_general.map_zoom_level),center:{lat:i(),lng:g()}}),o=new google.maps.Geocoder,t=new google.maps.Marker({map:e,position:new google.maps.LatLng(i(),g()),draggable:!0,animation:google.maps.Animation.DROP}),n(o,t,e),r({geocoder:o,marker:t,map:e,what:"address"}),s.addListener("place_changed",function(){a(null),r({geocoder:o,marker:t,map:e,what:"address"})})):l("#wcv_location_picker").hide()}),l("#show_location_picker").click(function(e){e.preventDefault(),l("#wcv_location_picker").toggle(),l("#wcv_location_picker").is(":visible")?l("#show_location_picker").text(wcv_frontend_general.hide_location_picker_text):l("#show_location_picker").text(wcv_frontend_general.use_location_picker_text)}),l("#use_current_position").click(function(e){e.preventDefault(),t()}),0<e.length?o.val(e).trigger("change"):t()})}(jQuery);